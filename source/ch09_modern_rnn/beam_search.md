# 束搜索 (Beam Search)

束搜索（Beam Search）是一种在序列生成任务中常用的搜索算法，特别是在机器翻译、文本摘要等任务中，用于从模型输出的概率分布中找到最优的序列。它是一种启发式搜索算法，介于贪婪搜索和穷举搜索之间。

## 贪婪搜索的局限性

在序列生成任务中，最直观的方法是**贪婪搜索（Greedy Search）**：在每个时间步，模型都选择当前概率最高的词作为输出。然而，这种局部最优的选择并不总是能导致全局最优的序列。一旦某个时间步选择了次优的词，后续的生成就可能受到影响，无法挽回。

## 束搜索的原理

束搜索通过在每个时间步保留多个（通常是 $k$ 个，称为**束宽 Beam Width**）当前最优的候选序列，而不是只保留一个。它在每个时间步扩展所有 $k$ 个候选序列，然后从所有可能的扩展中选择 $k$ 个概率最高的序列作为新的候选序列。

## 工作流程

1.  **初始化**：从起始符开始，生成第一个词，并保留 $k$ 个概率最高的词作为初始候选序列。
2.  **迭代扩展**：对于每个时间步，将每个候选序列扩展所有可能的下一个词。计算每个扩展序列的累积对数概率（通常使用对数概率以避免浮点数下溢）。
3.  **剪枝**：从所有扩展后的序列中，选择累积对数概率最高的 $k$ 个序列作为新的候选序列。
4.  **终止**：当所有 $k$ 个候选序列都生成了结束符（`<EOS>`）或者达到最大序列长度时，搜索终止。最终选择累积对数概率最高的序列作为最终输出。

## 优势与局限

- **优势**：束搜索能够找到比贪婪搜索更好的序列，因为它考虑了更多的可能性，从而提高了生成序列的质量。
- **局限**：束搜索不是一个最优搜索算法，它不能保证找到全局最优的序列。束宽 $k$ 的选择是一个权衡：$k$ 越大，搜索空间越大，找到更好序列的可能性越大，但计算成本也越高。

束搜索是序列生成模型中提高输出质量的关键技术之一。
