# 锚框 (Anchor Boxes)

锚框（Anchor Boxes），也称为先验框（Prior Boxes），是目标检测领域中一个非常重要的概念，尤其是在基于区域提议（Region Proposal）和单阶段（Single-Shot）检测器中。它旨在解决图像中物体尺寸和长宽比多样性的问题。

## 核心思想

在目标检测任务中，图像中的物体可能具有各种各样的大小和长宽比。如果模型只预测一个边界框，很难有效地覆盖所有这些变化。锚框的思路是：在图像的每个位置预设一组具有不同尺寸和长宽比的固定边界框。模型不再直接预测物体的边界框，而是预测：

1.  **每个锚框是否包含一个物体**（前景/背景分类）。
2.  **如果包含物体，则预测该物体相对于锚框的偏移量**（边界框回归）。
3.  **预测该物体的类别**。

## 锚框的生成

锚框通常在特征图的每个像素点上生成。例如，在一个 8x8 的特征图上，如果每个像素点生成 3 个锚框（例如，一个正方形、一个高矩形、一个宽矩形），那么总共就会有 $8 \times 8 \times 3 = 192$ 个锚框。

## 锚框的匹配

在训练过程中，需要将生成的锚框与图像中的真实物体（Ground Truth Boxes）进行匹配。通常使用交并比（IoU）来衡量锚框与真实物体之间的重叠程度：

-   如果锚框与某个真实物体的 IoU 大于某个阈值（如 0.7），则该锚框被认为是正样本（Positive Sample），并负责预测该物体。
-   如果锚框与所有真实物体的 IoU 都小于某个阈值（如 0.3），则该锚框被认为是负样本（Negative Sample），用于学习背景。
-   介于两者之间的锚框通常会被忽略。

## 优势

- **处理多尺度和多长宽比物体**：通过预设不同尺寸和长宽比的锚框，模型能够更好地检测图像中各种形状的物体。
- **简化学习任务**：模型不再需要从零开始预测边界框的坐标，而是预测相对于预设锚框的微小调整，这使得学习任务变得更容易。

锚框是现代目标检测算法（如 Faster R-CNN, SSD, YOLOv2/v3）的关键组成部分。
