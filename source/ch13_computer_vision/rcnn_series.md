# 区域卷积神经网络 (R-CNN) 系列

区域卷积神经网络（Region-based Convolutional Neural Network, R-CNN）系列是目标检测领域中具有里程碑意义的算法，它们将深度学习引入目标检测任务，并取得了显著的性能提升。R-CNN 系列通常被称为**两阶段（Two-Stage）检测器**，因为它们首先生成区域提议，然后对这些提议进行分类和边界框回归。

## 1. R-CNN (Region-based CNN)

R-CNN 是第一个将 CNN 应用于目标检测的算法。

- **工作流程**：
    1.  **区域提议 (Region Proposal)**：使用选择性搜索（Selective Search）等传统方法在图像中生成约 2000 个可能包含物体的区域提议。
    2.  **特征提取**：将每个区域提议缩放到固定大小，然后送入预训练的 CNN（如 AlexNet）提取特征。
    3.  **分类**：使用支持向量机（SVM）对每个区域提议的特征进行分类。
    4.  **边界框回归**：使用线性回归模型对边界框进行微调。

- **缺点**：
    - **速度慢**：每个区域提议都需要单独通过 CNN 提取特征，计算量巨大。
    - **训练复杂**：训练过程分为多个阶段，需要分别训练 SVM 和边界框回归器。

## 2. Fast R-CNN

Fast R-CNN 旨在解决 R-CNN 速度慢的问题。

- **核心改进**：
    - **共享卷积计算**：整个图像只进行一次 CNN 特征提取，然后通过 **RoI 池化层（Region of Interest Pooling）**从特征图中提取每个区域提议的特征。
    - **多任务损失**：将分类和边界框回归集成到一个统一的神经网络中进行端到端训练。

- **缺点**：区域提议仍然依赖于外部算法（如选择性搜索），这仍然是速度瓶颈。

## 3. Faster R-CNN

Faster R-CNN 进一步解决了 Fast R-CNN 的区域提议瓶颈，实现了真正的端到端目标检测。

- **核心改进**：
    - **区域提议网络 (Region Proposal Network, RPN)**：用一个小型卷积网络取代了传统的选择性搜索算法来生成区域提议。RPN 与检测网络共享卷积特征，使得区域提议的生成速度大大加快。

- **工作流程**：
    1.  **特征提取**：整个图像通过一个共享的 CNN 提取特征图。
    2.  **RPN**：在特征图上生成区域提议。
    3.  **RoI 池化**：从特征图中提取每个区域提议的特征。
    4.  **分类和回归**：对区域提议的特征进行分类和边界框回归。

Faster R-CNN 是两阶段目标检测器的代表，其思想对后续的目标检测算法产生了深远影响。
