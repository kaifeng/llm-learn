# NiN (Network in Network)

NiN（Network in Network）由 Min Lin 等人在 2013 年提出，是一个在 AlexNet 和 VGGNet 之间提出的、思想非常超前且影响深远的模型。它针对传统 CNN 的两个主要问题——卷积核的线性表达能力不足、以及网络末端全连接层参数量巨大易导致过拟合——提出了两大创新。

## 核心创新 1：NiN 块 与 1x1 卷积

为了增强卷积层的非线性能力，NiN 设计了 **NiN 块**：在一个标准的卷积层之后，紧跟两个 **1x1 的卷积层**。

这里的 1x1 卷积层起到了“跨通道的全连接”作用，它在不改变特征图宽高的情况下，对每个像素位置上的不同通道信息进行复杂的非线性组合（通过激活函数），极大地提升了网络的特征提取能力。这个设计也是 `1x1 卷积` 这一重要工具的早期成功应用。

![NiN 块](https://zh-v2.d2l.ai/_images/nin.svg)

## 核心创新 2：全局平均池化 (Global Average Pooling, GAP)

为了彻底取代参数量巨大的全连接层，NiN 创新性地在网络的最后使用了 **GAP 层**。

具体做法是，将网络最后一层的每个特征图（Feature Map）的所有像素值求平均，得到一个值。如果最后一层有 10 个特征图，GAP 之后就会得到一个长度为 10 的向量，然后将这个向量直接送入 Softmax 层进行分类。

**优点**：GAP 几乎没有参数，极大地减少了模型的总参数量，有效防止了过拟合，并且加强了特征图与最终类别之间的对应关系。这一思想后来被 GoogLeNet、ResNet 等模型广泛采纳。

## 影响

NiN 的思想非常具有前瞻性，其引入的 1x1 卷积和全局平均池化对后续的深度学习架构设计产生了深远影响，是许多现代 CNN 架构（如 GoogLeNet 和 ResNet）的重要组成部分。
